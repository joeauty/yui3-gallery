YUI.add("gallery-bt-shortcut",function(c){var h=c.one(".bt-shortcut-mask")||c.one("body").appendChild(c.Node.create('<div class="bt-shortcut-mask"></div>')),f="widthChange",d="heightChange",g="visibleChange",l,m,a=[],k,j,i={unveil:1,push:1},n={top:["tc",0,-1,"bc",0.5,0],bottom:["bc",0,1,"tc",0.5,1],left:["lc",-1,0,"rc",0,0.5],right:["rc",1,0,"lc",1,0.5]},e={"true":1,"false":1},b=c.Base.create("btshortcut",c.Widget,[c.WidgetParent,c.WidgetPosition,c.WidgetStack,c.WidgetPositionAlign,c.Bottle.PushPop],{initializer:function(){if(!l){l=c.Bottle.Page.getCurrent();if(l){m=l.get("boundingBox");l.set("zIndex",b.ZINDEX_PAGE);}}a.push(this);this._bscEventHandlers=new c.EventHandle([this.after(f,this._updatePositionShow),this.after(d,this._updatePositionShow),this.before(g,this._beforeShowHide),this.after(g,this._doShowHide)]);this.get("contentBox").setStyle("display","block");this._updatePositionHide();this._updatePositionShow();},destructor:function(){this._bscEventHandlers.detach();delete this._bscEventHandlers;},renderUI:function(){var q=this.get("boundingBox"),o=q.get("offsetWidth"),p=q.get("offsetHeight");if(!this.get("height")&&p){this.set("height",p);}if(!this.get("width")&&o){this.set("width",o);}},scResize:function(o){if(!o&&(this.get("width")===c.Bottle.Device.getBrowserWidth())){return;}if(!o&&(this.get("height")===c.Bottle.Device.getBrowserHeight())){return;}if(!this.get("visible")&&!o){return;}this._updateFullSize();this._updatePositionShow();},_updateFullSize:function(){if(this.get("fullHeight")){this.set("height",c.Bottle.Device.getBrowserHeight(),{noAlign:true});}if(this.get("fullWidth")){this.set("width",c.Bottle.Device.getBrowserWidth(),{noAlign:true});}},_updatePositionShow:function(p){var s=(p&&p.showFrom)?p.showFrom:this.get("showFrom"),o=(p&&(p.visible!==undefined))?p.visible:this.get("visible"),q=(p&&p.noAlign)?true:false,r=n[s];if(!o){return;}if(q){return;}m.setStyles({left:-r[1]*((p&&(p.attrName==="width"))?p.newVal:this.get("width"))+"px",top:-r[2]*((p&&(p.attrName==="height"))?p.newVal:this.get("height"))+"px"});this.align(m,[r[3],r[0]]);},_updatePositionHide:function(q){var o=(this.get("action")==="unveil"),p=(q&&(q.visible!==undefined))?q.visible:this.get("visible"),r=n[this.get("showFrom")];if(!p){this.align(null,[o?r[0]:r[3],r[0]]);}},_displayMask:function(o){h.setStyle("display",o?"block":"none");},_doTransition:function(q,s,r,o){var p=this;c.later(1,this,function(){q.transition(c.merge(this.get("scTrans"),{left:s+"px",top:r+"px"}),function(){if(o){o.apply(p);}});});},_beforeShowHide:function(p){var o=p.newVal;if(!k||!o||(k===this)){return;}j=this;p.halt();k.hide();},_doneShowHide:function(){var p=this.get("visible"),o=this.get("mask");if(o){this._displayMask(p);}this.set("disabled",p?false:true);this.set("zIndex",p?b.ZINDEX_SHOW:b.ZINDEX_HIDE);if(j){j.show();j=undefined;}},_doShowHide:function(s){var o=s.newVal,p=o?0:1,r=o?-1:0,t=n[this.get("showFrom")],q=this.get("boundingBox");if(o){this.enable();this._updateFullSize();this._updatePositionHide({visible:false});k=this;}else{this._updatePositionShow({visible:true});if(this.get("mask")){this._displayMask(false);}k=undefined;}this.set("zIndex",b.ZINDEX_HIDE);this._doTransition(m,r*t[1]*this.get("width"),r*t[2]*this.get("height"),this._doneShowHide);if(this.get("action")!=="unveil"){this._doTransition(q,t[4]*m.get("offsetWidth")+(p*t[1]-t[4])*this.get("width"),t[5]*m.get("offsetHeight")+(p*t[2]-t[5])*this.get("height"));}}},{ATTRS:{action:{value:"unveil",lazyAdd:false,validator:function(o){return i[o]?true:false;},setter:function(o){if(o!==this.get("action")){this._updatePositionShow({action:o});}return o;}},showFrom:{value:"left",lazyAdd:false,validator:function(o){return n[o]?true:false;},setter:function(p){var q,r=this.get("contentBox"),o=n[p][1];if(p===this.get("showFrom")){return p;}this._updatePositionShow({showFrom:p});q=r.getData("full-height");if(e[q]){this.set("fullHeight",q==="true");}else{this.set("fullHeight",(o!==0)?true:false);}q=r.getData("full-width");if(e[q]){this.set("fullWidth",q==="true");}else{this.set("fullWidth",o===0);}return p;}},mask:{value:true,validator:c.Lang.isBoolean,setter:function(o){if(this.get("visible")){this._displayMask(o);}return o;}},scTrans:{value:{duration:0.5}},fullHeight:{validator:c.Lang.isBoolean,lazyAdd:false,setter:function(o){if(o){this.scResize();}return o;}},fullWidth:{validator:c.Lang.isBoolean,lazyAdd:false,setter:function(o){if(o){this.scResize();}return o;}}},HTML_PARSER:{mask:function(o){if(o.getData("mask")==="false"){return false;}return true;},action:function(o){return o.getData("action");},showFrom:function(o){return o.getData("show-from");},scTrans:function(p){try{return c.JSON.parse(p.getData("cfg-sc-trans"));}catch(o){}}},ZINDEX_PAGE:100,ZINDEX_SHOW:200,ZINDEX_HIDE:10,getInstances:function(){return a;},getCurrent:function(){return k;}});c.Bottle.ShortCut=b;h.on("click",function(){k.hide();});},"@VERSION@",{requires:["widget-position-align","gallery-bt-page"]});