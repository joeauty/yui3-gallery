YUI.add("gallery-bt-shortcut",function(c){var k=c.one("body"),h=c.one(".bt-shortcut-mask")||k.appendChild(c.Node.create('<div class="bt-shortcut-mask"></div>')),f="widthChange",d="heightChange",g="visibleChange",m,n,a=[],l,j,i={unveil:1,push:1},o={top:["tc",0,-1,"bc",0.5,0],bottom:["bc",0,1,"tc",0.5,1],left:["lc",-1,0,"rc",0,0.5],right:["rc",1,0,"lc",1,0.5]},e={"true":1,"false":1},b=c.Base.create("btshortcut",c.Widget,[c.WidgetParent,c.WidgetPosition,c.WidgetStack,c.WidgetPositionAlign,c.Bottle.PushPop],{initializer:function(){if(!m){m=c.Bottle.Page.getCurrent();if(m){n=m.get("boundingBox");m.set("zIndex",b.ZINDEX_PAGE);}}a.push(this);this._bscEventHandlers=new c.EventHandle([this.after(f,this._updatePositionShow),this.after(d,this._updatePositionShow),this.before(g,this._beforeShowHide),this.after(g,this._doShowHide)]);this.get("contentBox").setStyle("display","block");this._updatePositionHide();this._updatePositionShow();},destructor:function(){this._bscEventHandlers.detach();delete this._bscEventHandlers;},renderUI:function(){var s=this.get("boundingBox"),r=this.get("contentBox"),p=s.get("offsetWidth")||r.get("offsetWidth"),q=s.get("offsetHeight")||r.get("offsetHeight");if(!this.get("height")&&q){this.set("height",q);}if(!this.get("width")&&p){this.set("width",p);}},scResize:function(p){if(!p&&(this.get("width")===c.Bottle.Device.getBrowserWidth())){return;}if(!p&&(this.get("height")===c.Bottle.Device.getBrowserHeight())){return;}if(!this.get("visible")&&!p){return;}this._updateFullSize();this._updatePositionShow();},_updateFullSize:function(){if(this.get("fullHeight")){this.set("height",c.Bottle.Device.getBrowserHeight(),{noAlign:true});}if(this.get("fullWidth")){this.set("width",c.Bottle.Device.getBrowserWidth(),{noAlign:true});}},_updatePositionShow:function(q){var t=(q&&q.showFrom)?q.showFrom:this.get("showFrom"),p=(q&&(q.visible!==undefined))?q.visible:this.get("visible"),r=(q&&q.noAlign)?true:false,s=o[t];if(!p){return;}if(r){return;}n.setStyles({left:-s[1]*((q&&(q.attrName==="width"))?q.newVal:this.get("width"))+"px",top:-s[2]*((q&&(q.attrName==="height"))?q.newVal:this.get("height"))+"px"});this.align(n,[s[3],s[0]]);},_updatePositionHide:function(r){var p=(this.get("action")==="unveil"),q=(r&&(r.visible!==undefined))?r.visible:this.get("visible"),s=o[this.get("showFrom")];if(!q){this.align(k,[p?s[0]:s[3],s[0]]);}},_displayMask:function(p){h.setStyle("display",p?"block":"none");},_doTransition:function(r,t,s,p){var q=this;c.later(1,this,function(){r.transition(c.merge(this.get("scTrans"),{left:t+"px",top:s+"px"}),function(){if(p){p.apply(q);}});});},_beforeShowHide:function(q){var p=q.newVal;if(!l||!p||(l===this)){return;}j=this;q.halt();l.hide();},_doneShowHide:function(){var q=this.get("visible"),p=this.get("mask");if(p){this._displayMask(q);}this.set("disabled",q?false:true);this.set("zIndex",q?b.ZINDEX_SHOW:b.ZINDEX_HIDE);if(j){j.show();j=undefined;}},_doShowHide:function(t){var p=t.newVal,q=p?0:1,s=p?-1:0,u=o[this.get("showFrom")],r=this.get("boundingBox");if(p){this.enable();this._updateFullSize();this._updatePositionHide({visible:false});l=this;}else{this._updatePositionShow({visible:true});if(this.get("mask")){this._displayMask(false);}l=undefined;}this.set("zIndex",b.ZINDEX_HIDE);this._doTransition(n,s*u[1]*this.get("width"),s*u[2]*this.get("height"),this._doneShowHide);if(this.get("action")!=="unveil"){this._doTransition(r,u[4]*n.get("offsetWidth")+(q*u[1]-u[4])*this.get("width"),u[5]*n.get("offsetHeight")+(q*u[2]-u[5])*this.get("height"));}}},{ATTRS:{action:{value:"unveil",lazyAdd:false,validator:function(p){return i[p]?true:false;},setter:function(p){if(p!==this.get("action")){this._updatePositionShow({action:p});}return p;}},showFrom:{value:"left",lazyAdd:false,validator:function(p){return o[p]?true:false;},setter:function(q){var r,s=this.get("contentBox"),p=o[q][1];if(q===this.get("showFrom")){return q;}this._updatePositionShow({showFrom:q});r=s.getData("full-height");if(e[r]){this.set("fullHeight",r==="true");}else{this.set("fullHeight",(p!==0)?true:false);}r=s.getData("full-width");if(e[r]){this.set("fullWidth",r==="true");}else{this.set("fullWidth",p===0);}return q;}},mask:{value:true,validator:c.Lang.isBoolean,setter:function(p){if(this.get("visible")){this._displayMask(p);}return p;}},scTrans:{value:{duration:0.5}},fullHeight:{validator:c.Lang.isBoolean,lazyAdd:false,setter:function(p){if(p){this.scResize();}return p;}},fullWidth:{validator:c.Lang.isBoolean,lazyAdd:false,setter:function(p){if(p){this.scResize();}return p;}}},HTML_PARSER:{mask:function(p){if(p.getData("mask")==="false"){return false;}return true;},action:function(p){return p.getData("action");},showFrom:function(p){return p.getData("show-from");},scTrans:function(q){try{return c.JSON.parse(q.getData("cfg-sc-trans"));}catch(p){}}},ZINDEX_PAGE:100,ZINDEX_SHOW:200,ZINDEX_HIDE:10,getInstances:function(){return a;},getCurrent:function(){return l;}});c.Bottle.ShortCut=b;h.on("click",function(){l.hide();});},"@VERSION@",{requires:["widget-position-align","gallery-bt-page"]});