YUI.add("gallery-nmpjaxplus",function(a){YUI.add("gallery-nmpjaxplus",function(b){b.PjaxPlus=b.Base.create("pjaxplus",b.Widget,[],{initializer:function(c){this.set("history",new b.History());this.set("html5support",b.HistoryBase.html5);this.ppCache=new b.Cache({max:this.get("cacheNum")});this.domain=new RegExp("^(http|https)://"+window.location.hostname.replace(".","."));if(this.get("omitLinkClass").match(/^\./)){this.set("omitLinkClass",this.get("omitLinkClass").replace(/^\./,""));}},initAjaxLinks:function(){var d,c;if(this.get("html5support")){var e=false;b.all("a:not(."+this.get("omitLinkClass")+")").each(function(h){var j=h.get("pathname").split(/\//);var i=j.length-1;var g=j[i];if(!g.match(/\./)){e=true;}else{e=b.Array.some(this.get("permittedFileExts"),function(l){var k=new RegExp("."+l+"$");if(g.match(k)){return true;}});}if(e&&!h.get("href").match(/^(mailto|javascript):/)&&!h.get("href").match(/^#/)&&h.get("href").match(this.domain)&&!h.hasClass(this.get("omitLinkClass"))){h.addClass("yui3-pjax");}},this);var f=new b.Pjax({addPjaxParam:this.get("addPjaxParam"),container:this.get("container"),contentSelector:this.get("contentSelector"),linkSelector:this.get("linkSelector"),navigateOnHash:this.get("navigateOnHash"),scrollToTop:this.get("scrollToTop"),timeout:this.get("timeout"),titleSelector:this.get("titleSelector")});f.on("navigate",function(h){d=h.originEvent.target.get("href");var g=this.get("html5support");if(this.get("startCallbackFunc")&&!this.ppCache.retrieve(d)){this.get("startCallbackFunc").call(null,{clickTarget:h.originEvent.target,path:h.originEvent.target.get("pathname"),url:h.originEvent.target.get("href"),html5support:g},this);}},this);f.after("load",function(h){var g=this.get("html5support");if(this.get("callbackFunc")){this.get("callbackFunc").call(null,{clickTarget:c,path:c.get("pathname"),url:c.get("href"),html5support:g},this);}b.all(this.get("container")+" a:not(."+this.get("omitLinkClass")+")").addClass("yui3-pjax");this.ppCache.add(d,b.one(this.get("contentSelector")).getContent());},this);b.delegate("click",function(g){c=g.target;if(this.ppCache.retrieve(g.target.get("href"))){b.one(this.get("contentSelector")).setContent(this.ppCache.retrieve(g.target.get("href")).response);}},document.body,"a.yui3-pjax",this);}else{b.delegate("click",function(m){var g=this.get("html5support");if(typeof m.target.get("pathname")!=="undefined"){var i=m.target.get("pathname").replace(/_/g,"-");i=m.target.get("pathname").replace(/\//g,"_");if(this.ppCache.retrieve(m.target.get("href"))){b.one(this.get("contentSelector")).setContent(this.ppCache.retrieve(m.target.get("href")).response);this.get("history").add({page:i});if(this.get("callbackFunc")){this.get("callbackFunc").call(null,{clickTarget:m.target,path:m.target.get("pathname"),url:m.target.get("href"),historyhash:i,html5support:g},this);}return;}}var j=false;if(typeof m.target.get("pathname")=="undefined"){m.preventDefault();this.startAjaxLoad({clickTarget:m.target,url:"/"});}else{var l=m.target.get("pathname").split(/\//);var k=l.length-1;var h=l[k];if(!h.match(/\./)){j=true;}else{j=b.Array.some(this.get("permittedFileExts"),function(o){var n=new RegExp("."+o+"$");if(h.match(n)){return true;}});}if(j&&!m.target.get("href").match(/^(mailto|javascript):/)&&!m.target.get("href").match(/^#/)&&m.target.get("href").match(this.domain)&&!m.target.hasClass(this.get("omitLinkClass"))){m.preventDefault();this.startAjaxLoad({clickTarget:m.target,path:m.target.get("pathname"),url:m.target.get("href"),historyhash:i,html5support:g});}}},this.get("findLinksIn"),"a:not(."+this.get("omitLinkClass")+")",this);}},startAjaxLoad:function(d){if(this.get("startCallbackFunc")&&!this.ppCache.retrieve(d.url)){this.get("startCallbackFunc").call(null,d,this);}var c={timeout:this.get("timeout"),on:{complete:b.bind(function(g,f){var e=b.Node.create(f.responseText);b.one(this.get("contentSelector")).setContent(e.one(this.get("contentSelector")).getContent());this.get("history").add({page:d.historyhash});this.ppCache.add(d.url,e.one(this.get("contentSelector")).getContent());},this),success:b.bind(function(f,e){d.transport=e;if(this.get("callbackFunc")){this.get("callbackFunc").call(null,d,this);}},this)}};b.io(d.url,c);}},{ATTRS:{findLinksIn:{value:document.body},container:{},timeout:{value:30000},addPjaxParam:{value:true},linkSelector:{value:"a.yui3-pjax"},scrollToTop:{value:true},navigateOnHash:{value:false},titleSelector:{value:"title"},contentSelector:{},omitLinkClass:{},permittedFileExts:{},startCallbackFunc:{},callbackFunc:{},cacheNum:{value:10}}});},"gallery-2012.08.01-13-16",{requires:["base-build","widget","node","io","history","pjax","event-delegate","cache-base","selector-css3"]});},"gallery-2012.08.01-13-16",{requires:["base-build","widget","node","io","history","pjax","event-delegate","cache-base","selector-css3"],skinnable:false});