YUI.add("gallery-bt-overlay",function(c){var g=c.one(".bt-overlay-mask")||c.one("body").appendChild(c.Node.create('<div class="bt-overlay-mask"></div>')),e="widthChange",d="heightChange",f="visibleChange",j,k,a=[],i,h,l={top:["tc",0,-1,"bc",0.5,0],bottom:["bc",0,1,"tc",0.5,1],left:["lc",-1,0,"rc",0,0.5],right:["rc",1,0,"lc",1,0.5]},b=c.Base.create("btoverlay",c.Widget,[c.WidgetParent,c.WidgetPosition,c.WidgetStack,c.WidgetPositionAlign,c.Bottle.PushPop],{initializer:function(){if(!j){j=c.Bottle.Page.getCurrent();if(j){k=j.get("boundingBox");j.set("zIndex",b.ZINDEX_PAGE);}}a.push(this);this._bscEventHandlers=new c.EventHandle([this.after(e,this._updatePositionShow),this.after(d,this._updatePositionShow),this.after(f,this._doShowHide)]);},destructor:function(){this._bscEventHandlers.detach();delete this._bscEventHandlers;},renderUI:function(){var o=this.get("boundingBox"),m=o.get("offsetWidth"),n=o.get("offsetHeight");if(!this.get("height")&&n){this.set("height",n);}if(!this.get("width")&&m){this.set("width",m);}},olResize:function(m){if(!m&&(this.get("width")===c.Bottle.Device.getBrowserWidth())){return;}if(!m&&(this.get("height")===c.Bottle.Device.getBrowserHeight())){return;}if(!this.get("visible")&&!m){return;}this._updateFullSize();this._updatePositionShow();},_updateFullSize:function(){if(this.get("fullPage")){this.set("width",c.Bottle.Device.getBrowserWidth(),{noAlign:true});this.set("height",c.Bottle.Device.getBrowserHeight(),{noAlign:true});}},_updatePositionShow:function(n){var q=(n&&n.showFrom)?n.showFrom:this.get("showFrom"),m=(n&&(n.visible!==undefined))?n.visible:this.get("visible"),o=(n&&n.noAlign)?true:false,p=l[q];if(!m){return;}if(o){return;}if(this.get("fullPage")){this.align(k,[p[3],p[3]]);}else{this.centered(k);}},_updatePositionHide:function(n){var m=(n&&(n.visible!==undefined))?n.visible:this.get("visible"),o=l[this.get("showFrom")];if(!m){this.align(null,[o[3],o[0]]);}},_displayMask:function(m){g.setStyle("display",m?"block":"none");},_doTransition:function(o,q,p,m){var n=this;c.later(1,this,function(){o.transition(c.merge(this.get("olTrans"),{left:q+"px",top:p+"px"}),function(){if(m){m.apply(n);}});});},_doneShowHide:function(){var n=this.get("visible"),m=this.get("mask");if(m){this._displayMask(n);}this.set("disabled",n?false:true);this.set("zIndex",n?b.ZINDEX_SHOW:b.ZINDEX_HIDE);if(h){h.show();h=undefined;}},_doShowHide:function(u){var t=u.newVal,s=t?0:1,q=t?-1:0,r=l[this.get("showFrom")],p=this.get("boundingBox"),m,o,n;if(t){this.enable();this._updateFullSize();this._updatePositionHide({visible:false});i=this;}else{this._updatePositionShow({visible:true});if(this.get("mask")){this._displayMask(false);}i=undefined;}this.set("zIndex",b.ZINDEX_SHOW);if(this.get("fullPage")){this._doTransition(p,r[4]*k.get("offsetWidth")+(s*r[1]-r[4])*this.get("width"),r[5]*k.get("offsetHeight")+(s*r[2]-r[5])*this.get("height"),this._doneShowHide);}else{m=k.get("region");if(t){o=m.left+Math.floor(m.width/2)-(this.get("width")/2);n=m.top+Math.floor(m.height/2)-(this.get("height")/2);}else{switch(this.get("showFrom")){case"top":o=m.left+Math.floor(m.width/2)-(this.get("width")/2);n=-this.get("height");break;case"bottom":o=m.left+Math.floor(m.width/2)-(this.get("width")/2);n=m.bottom;break;case"right":o=m.right;n=m.top+Math.floor(m.height/2)-(this.get("height")/2);break;case"left":default:o=-this.get("width");n=m.top+Math.floor(m.height/2)-(this.get("height")/2);break;}}this._doTransition(p,o,n,this._doneShowHide);}}},{ATTRS:{showFrom:{value:"left",lazyAdd:false,validator:function(m){return l[m]?true:false;},setter:function(n){var o,p=this.get("contentBox"),m=l[n][1];if(n===this.get("showFrom")){return n;}this._updatePositionShow({showFrom:n});return n;}},mask:{value:true,validator:c.Lang.isBoolean,setter:function(m){if(this.get("visible")){this._displayMask(m);}return m;}},olTrans:{value:{duration:0.5}},fullPage:{value:true,validator:c.Lang.isBoolean,lazyAdd:false,setter:function(m){if(m){this.olResize();}return m;}}},HTML_PARSER:{mask:function(m){if(m.getData("mask")==="false"){return false;}return true;},showFrom:function(m){return m.getData("show-from");},olTrans:function(n){try{return c.JSON.parse(n.getData("cfg-ol-trans"));}catch(m){}},fullPage:function(m){if(m.getData("full-page")==="false"){return false;}return true;}},ZINDEX_PAGE:100,ZINDEX_SHOW:300,ZINDEX_HIDE:10,getInstances:function(){return a;},getCurrent:function(){return i;}});c.Bottle.Overlay=b;g.on("click",function(){i.hide();});},"@VERSION@",{requires:["widget-position-align","gallery-bt-page"]});