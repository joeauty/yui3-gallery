YUI.add("gallery-bt-overlay",function(c){var g=c.one(".bt-overlay-mask")||c.one("body").appendChild(c.Node.create('<div class="bt-overlay-mask"></div>')),e="widthChange",d="heightChange",f="visibleChange",a=[],j,i=c.one("body"),h,k={top:["tc",0,-1,"bc",0.5,0],bottom:["bc",0,1,"tc",0.5,1],left:["lc",-1,0,"rc",0,0.5],right:["rc",1,0,"lc",1,0.5]},b=c.Base.create("btoverlay",c.Widget,[c.WidgetParent,c.WidgetPosition,c.WidgetStack,c.WidgetPositionAlign,c.Bottle.PushPop],{initializer:function(l){a.push(this);if(!l.zIndex){this.set("zIndex",200);}this._bscEventHandlers=new c.EventHandle([this.after(e,this._updatePositionShow),this.after(d,this._updatePositionShow),this.after(f,this._doShowHide)]);},destructor:function(){this._bscEventHandlers.detach();delete this._bscEventHandlers;},renderUI:function(){var n=this.get("boundingBox"),l=n.get("offsetWidth"),m=n.get("offsetHeight");if(!this.get("height")&&m){this.set("height",m);}if(!this.get("width")&&l){this.set("width",l);}},olResize:function(l){if(!l&&(this.get("width")===c.Bottle.Device.getBrowserWidth())){return;}if(!l&&(this.get("height")===c.Bottle.Device.getBrowserHeight())){return;}if(!this.get("visible")&&!l){return;}this._updateFullSize();this._updatePositionShow();},_updateFullSize:function(){if(this.get("fullPage")){this.set("width",c.Bottle.Device.getBrowserWidth(),{noAlign:true});this.set("height",c.Bottle.Device.getBrowserHeight(),{noAlign:true});}},_updatePositionShow:function(m){var p=(m&&m.showFrom)?m.showFrom:this.get("showFrom"),l=(m&&(m.visible!==undefined))?m.visible:this.get("visible"),n=(m&&m.noAlign)?true:false,o=k[p];if(!l){return;}if(n){return;}if(this.get("fullPage")){this.align(i,[o[3],o[3]]);}else{this.centered(i);}},_updatePositionHide:function(m){var l=(m&&(m.visible!==undefined))?m.visible:this.get("visible"),n=k[this.get("showFrom")];if(!l){this.align(null,[n[3],n[0]]);}},_displayMask:function(l){g.setStyle("display",l?"block":"none");},_doTransition:function(n,p,o,l){var m=this;c.later(1,this,function(){n.transition(c.merge(this.get("olTrans"),{left:p+"px",top:o+"px"}),function(){if(l){l.apply(m);}});});},_doneShowHide:function(){var m=this.get("visible"),l=this.get("mask");if(l){this._displayMask(m);}this.set("disabled",m?false:true);if(h){h.show();h=undefined;}},_doShowHide:function(t){var s=t.newVal,r=s?0:1,p=s?-1:0,q=k[this.get("showFrom")],o=this.get("boundingBox"),l,n,m;if(s){this.enable();this._updateFullSize();this._updatePositionHide({visible:false});j=this;}else{this._updatePositionShow({visible:true});if(this.get("mask")){this._displayMask(false);}j=undefined;}if(this.get("fullPage")){this._doTransition(o,q[4]*i.get("offsetWidth")+(r*q[1]-q[4])*this.get("width"),q[5]*i.get("offsetHeight")+(r*q[2]-q[5])*this.get("height"),this._doneShowHide);}else{l=i.get("region");if(s){n=l.left+Math.floor(l.width/2)-(this.get("width")/2);m=l.top+Math.floor(l.height/2)-(this.get("height")/2);}else{switch(this.get("showFrom")){case"top":n=l.left+Math.floor(l.width/2)-(this.get("width")/2);m=-this.get("height");break;case"bottom":n=l.left+Math.floor(l.width/2)-(this.get("width")/2);m=l.bottom;break;case"right":n=l.right;m=l.top+Math.floor(l.height/2)-(this.get("height")/2);break;case"left":default:n=-this.get("width");m=l.top+Math.floor(l.height/2)-(this.get("height")/2);break;}}this._doTransition(o,n,m,this._doneShowHide);}}},{ATTRS:{showFrom:{value:"left",lazyAdd:false,validator:function(l){return k[l]?true:false;},setter:function(m){var n,o=this.get("contentBox"),l=k[m][1];if(m===this.get("showFrom")){return m;}this._updatePositionShow({showFrom:m});return m;}},mask:{value:true,validator:c.Lang.isBoolean,setter:function(l){if(this.get("visible")){this._displayMask(l);}return l;}},olTrans:{value:{duration:0.5}},fullPage:{value:true,validator:c.Lang.isBoolean,lazyAdd:false,setter:function(l){if(l){this.olResize();}return l;}}},HTML_PARSER:{mask:function(l){if(l.getData("mask")==="false"){return false;}return true;},showFrom:function(l){return l.getData("show-from");},olTrans:function(m){try{return c.JSON.parse(m.getData("cfg-ol-trans"));}catch(l){}},fullPage:function(l){if(l.getData("full-page")==="false"){return false;}return true;}},getInstances:function(){return a;},getCurrent:function(){return j;}});c.Bottle.Overlay=b;g.on("click",function(){j.hide();});},"@VERSION@",{requires:["widget-position-align","gallery-bt-page"]});